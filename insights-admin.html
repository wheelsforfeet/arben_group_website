<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Arben Group | Insights Admin</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@300;400;700&family=Montserrat:wght@500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="arben-style.css">
  <style>
    main{padding-top:96px;padding-bottom:80px;}
    .admin-hero{padding-top:96px;padding-bottom:32px;}
    .admin-grid{display:grid;grid-template-columns:1.1fr 0.9fr;gap:1.5rem;align-items:start;}
    .stack{display:grid;gap:1rem;}
    .card h3{margin-bottom:.35rem;}
    .pill-list{display:flex;flex-wrap:wrap;gap:.35rem;margin-top:.35rem;}
    .pill-list .pill{cursor:default;}
    .help{color:var(--muted);font-size:var(--text-sm);margin-top:.35rem;}
    .inline-fields{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1rem;}
    .logs{max-height:520px;overflow:auto;}
    @media(max-width:980px){.admin-grid{grid-template-columns:1fr;}}
  </style>
</head>
<body>
  <a href="#main-content" class="skip-link">Skip to main content</a>
  <header>
    <div class="brand">The Arben Group</div>
    <button class="nav-toggle" aria-expanded="false" aria-controls="primary-nav" aria-label="Toggle navigation">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </button>
    <nav id="primary-nav">
      <a href="index.html#problem">Problem</a>
      <a href="index.html#approach">Approach</a>
      <a href="index.html#services">Services</a>
      <a href="insights.html">Insights</a>
    </nav>
  </header>

  <main id="main-content" class="container">
    <section class="admin-hero">
      <p class="micro">Admin • Insights</p>
      <h1>Add new insight entries with owners and tags.</h1>
      <p class="lead">Entries saved here are stored in your browser (localStorage) and automatically displayed on the Insights page for anyone using this browser. For a shared/live site, connect this form to your CMS or API later.</p>
    </section>

    <section class="admin-grid">
      <!-- Form -->
      <div class="stack">
        <div class="card">
          <h3>New insight</h3>
          <form id="admin-form" class="stack" autocomplete="off">
            <div class="field">
              <label for="title">Title</label>
              <input id="title" name="title" type="text" placeholder="Decision Rights Without Drama" required />
            </div>
            <div class="field">
              <label for="url">Link (optional)</label>
              <input id="url" name="url" type="url" placeholder="https://example.com/insight" />
            </div>
            <div class="inline-fields">
              <div class="field">
                <label for="author">Ownership</label>
                <select id="author" name="author" required>
                  <option value="ben">Ben Harris</option>
                  <option value="arden">Arden Smith</option>
                  <option value="research">Research Library</option>
                </select>
              </div>
              <div class="field">
                <label for="type">Content type</label>
                <select id="type" name="type" required>
                  <option value="essay">Essay</option>
                  <option value="brief">Brief</option>
                  <option value="field-note">Field Note</option>
                  <option value="perspective">Perspective</option>
                  <option value="research">Research</option>
                </select>
              </div>
            </div>
            <div class="field">
              <label for="summary">Summary</label>
              <textarea id="summary" name="summary" rows="3" placeholder="Short abstract or teaser" required></textarea>
            </div>
            <div class="field">
              <label for="tags">Category tags (comma separated)</label>
              <input id="tags" name="tags" type="text" placeholder="leadership, culture, retention" />
              <div class="help">Use keywords visitors filter by (e.g., leadership, culture, retention, resilience, clinical).</div>
            </div>
            <button class="submit" type="submit">Save entry</button>
            <p id="admin-status" class="form-status" aria-live="polite"></p>
          </form>
        </div>
      </div>

      <!-- Preview / Existing -->
      <div class="stack">
        <div class="card logs">
          <h3>Stored entries</h3>
          <div id="entries-list" class="stack"></div>
        </div>
        <div class="card">
          <h3>How this works</h3>
          <p class="muted">Entries are kept in <strong>localStorage</strong> under <code>arbenInsightsEntries</code>. The Insights page reads from that key and renders items alongside the seed examples. To reset, clear your browser storage.</p>
          <div class="pill-list">
            <span class="pill">Owner: Ben | Arden | Research</span>
            <span class="pill">Type: Essay/Brief/Field Note/Research</span>
            <span class="pill">Tags: leadership, culture, retention…</span>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="container footer-flex">
      <div>© 2025 The Arben Group</div>
      <div class="muted">Strong cultures don’t happen by accident. They’re built — one keystone at a time.</div>
    </div>
  </footer>

  <script>
    // Nav toggle reuse
    const navToggle = document.querySelector('.nav-toggle');
    const primaryNav = document.getElementById('primary-nav');
    if(navToggle && primaryNav){
      navToggle.addEventListener('click', ()=>{
        const expanded = navToggle.getAttribute('aria-expanded') === 'true';
        navToggle.setAttribute('aria-expanded', String(!expanded));
        primaryNav.classList.toggle('is-open', !expanded);
      });
    }

    const STORAGE_KEY = 'arbenInsightsEntries';
    const form = document.getElementById('admin-form');
    const statusEl = document.getElementById('admin-status');
    const entriesList = document.getElementById('entries-list');

    function loadEntries(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        return raw ? JSON.parse(raw) : [];
      }catch(err){
        console.error('Failed to read storage', err);
        return [];
      }
    }

    function saveEntries(entries){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(entries));
    }

    function renderEntries(){
      const entries = loadEntries();
      entriesList.innerHTML = '';
      if(!entries.length){
        entriesList.innerHTML = '<p class=\"muted\">No custom entries yet.</p>';
        return;
      }
      entries.forEach((entry, idx) => {
        const div = document.createElement('div');
        div.className = 'surface';
        div.style.padding = '12px 14px';
        div.style.borderRadius = '12px';
        div.innerHTML = \n`<div class=\"meta-line\">${entry.authorLabel || entry.author} • ${entry.type || 'entry'}</div>\n<h4 style=\"margin:4px 0;\">${entry.title}</h4>\n<p class=\"muted\" style=\"margin:4px 0 6px;\">${entry.summary || ''}</p>\n<div class=\"pill-row\">${(entry.tags||[]).map(t=>`<span class=\"pill\">${t}</span>`).join('')}</div>\n<div class=\"help\">Link: ${entry.url ? `<a href=\"${entry.url}\" target=\"_blank\" rel=\"noopener\">${entry.url}</a>` : '—'}</div>\n<button data-idx=\"${idx}\" class=\"btn-quiet\" style=\"margin-top:6px;\">Remove</button>`;\n        entriesList.appendChild(div);\n      });
      entriesList.querySelectorAll('button[data-idx]').forEach(btn => {\n        btn.addEventListener('click', ()=>{\n          const idx = Number(btn.dataset.idx);\n          const entries = loadEntries();\n          entries.splice(idx,1);\n          saveEntries(entries);\n          renderEntries();\n          statusEl.textContent = 'Entry removed.';\n        });\n      });\n    }

    function normalizeAuthor(label){\n      const map = { ben: 'Ben Harris', arden: 'Arden Smith', research: 'Research Library' };\n      return map[label] || label;\n    }\n\n    if(form){\n      form.addEventListener('submit', (e)=>{\n        e.preventDefault();\n        const formData = new FormData(form);\n        const entry = {\n          title: formData.get('title')?.trim(),\n          url: formData.get('url')?.trim(),\n          author: formData.get('author'),\n          authorLabel: normalizeAuthor(formData.get('author')),\n          type: formData.get('type'),\n          summary: formData.get('summary')?.trim(),\n          tags: (formData.get('tags') || '').split(',').map(t=>t.trim()).filter(Boolean),\n          created: new Date().toISOString(),\n        };\n\n        if(!entry.title || !entry.author || !entry.summary){\n          statusEl.textContent = 'Title, author, and summary are required.';\n          return;\n        }\n\n        const entries = loadEntries();\n        entries.unshift(entry);\n        saveEntries(entries);\n        renderEntries();\n        form.reset();\n        statusEl.textContent = 'Saved. Refresh Insights page to see it.';\n      });\n    }\n\n    renderEntries();\n  </script>\n</body>\n</html>\n*** End Patch
